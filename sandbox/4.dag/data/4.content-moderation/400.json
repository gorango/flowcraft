{
	"nodes": [
		{
			"id": "check_for_pii",
			"type": "llm-condition",
			"data": {
				"promptTemplate": "Does the following text contain any Personally Identifiable Information (PII) like an email address, phone number, or physical address? Respond only with 'true' or 'false'.\n\nText: \"{{userPost}}\"",
				"inputs": {
					"userPost": "userPost"
				}
			}
		},
		{
			"id": "check_for_hate_speech",
			"type": "llm-process",
			"data": {
				"promptTemplate": "Analyze the following text for hate speech. Respond with only ONE of the following severity levels: 'none', 'moderate', or 'severe'.\n\nText: \"{{userPost}}\"",
				"inputs": {
					"userPost": "userPost"
				}
			}
		},
		{
			"id": "check_for_spam",
			"type": "llm-condition",
			"data": {
				"promptTemplate": "Does the following text appear to be commercial spam, containing suspicious links or promotional language? Respond only with 'true' or 'false'.\n\nText: \"{{userPost}}\"",
				"inputs": {
					"userPost": "userPost"
				}
			}
		},
		{
			"id": "triage_post",
			"type": "llm-router",
			"data": {
				"promptTemplate": "Given the following analysis of a user post, decide on the single most appropriate action. Respond with ONLY ONE of the following action codes: 'action_ban', 'action_redact', 'action_delete_spam', 'action_approve'.\n\n- Hate Speech Level: {{hate_speech_level}}\n- PII Found: {{pii_found}}\n- Spam Detected: {{spam_detected}}\n\nRules:\n1. If Hate Speech is 'severe', the action is 'action_ban'.\n2. If PII is 'true' (and hate speech is not 'severe'), the action is 'action_redact'.\n3. If Spam is 'true' (and the above are false), the action is 'action_delete_spam'.\n4. Otherwise, the action is 'action_approve'.",
				"inputs": {
					"hate_speech_level": "check_for_hate_speech",
					"pii_found": "check_for_pii",
					"spam_detected": "check_for_spam"
				}
			}
		},
		{
			"id": "ban_user_branch",
			"type": "sub-workflow",
			"data": {
				"workflowId": 401,
				"inputs": {
					"userId": "userId",
					"reason": "check_for_hate_speech"
				},
				"outputs": {
					"moderation_result": "ban_summary"
				}
			}
		},
		{
			"id": "redact_post_branch",
			"type": "sub-workflow",
			"data": {
				"workflowId": 402,
				"inputs": {
					"userPost": "userPost",
					"userId": "userId"
				},
				"outputs": {
					"moderation_result": "redaction_summary"
				}
			}
		},
		{
			"id": "delete_spam_branch",
			"type": "sub-workflow",
			"data": {
				"workflowId": 403,
				"inputs": {
					"userId": "userId"
				},
				"outputs": {
					"moderation_result": "spam_deletion_summary"
				}
			}
		},
		{
			"id": "approve_post_branch",
			"type": "llm-process",
			"data": {
				"promptTemplate": "The user post from {{userId}} was analyzed and approved with no issues. Create a simple log message confirming this.",
				"inputs": {
					"userId": "userId"
				}
			}
		},
		{
			"id": "final_log",
			"type": "output",
			"data": {
				"promptTemplate": "--- CONTENT MODERATION COMPLETE ---\n\nFinal Action Log:\n{{final_action_taken}}",
				"inputs": {
					"final_action_taken": [
						"moderation_result",
						"approve_post_branch"
					]
				}
			}
		}
	],
	"edges": [
		{
			"source": "check_for_pii",
			"target": "triage_post"
		},
		{
			"source": "check_for_hate_speech",
			"target": "triage_post"
		},
		{
			"source": "check_for_spam",
			"target": "triage_post"
		},
		{
			"source": "triage_post",
			"target": "ban_user_branch",
			"action": "action_ban"
		},
		{
			"source": "triage_post",
			"target": "redact_post_branch",
			"action": "action_redact"
		},
		{
			"source": "triage_post",
			"target": "delete_spam_branch",
			"action": "action_delete_spam"
		},
		{
			"source": "triage_post",
			"target": "approve_post_branch",
			"action": "action_approve"
		},
		{
			"source": "ban_user_branch",
			"target": "final_log"
		},
		{
			"source": "redact_post_branch",
			"target": "final_log"
		},
		{
			"source": "delete_spam_branch",
			"target": "final_log"
		},
		{
			"source": "approve_post_branch",
			"target": "final_log"
		}
	]
}
